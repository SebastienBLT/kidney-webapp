<div style="border:1px solid green;">

</div>
<div style="display: flex;flex-direction: row;">

<mat-card style="width:22%;border: 1px solid red;">

    <mat-form-field appearance="fill">
        <select matNativeControl (change)="changeInstance($event)" >
          <option>Choisissez une instance</option>
          <option *ngFor="let item of jsonResults.results ; let i=index" [value]="i">
            {{item.instance.name}}
          </option>
        </select>
      </mat-form-field>

      <mat-list *ngIf="selectedInstance" style="margin-top: 50px;">
        <h4 style="margin-bottom: 15px">Propriétés de l'instance</h4>
        <mat-list-item>Nom de l'instance : {{selectedInstance.instance.name}}</mat-list-item>
        <mat-list-item>Nombre de Paires : {{selectedInstance.instance.properties.nbPairs}}</mat-list-item>
        <mat-list-item>Nombre d'Altruists : {{selectedInstance.instance.altruists.length}}</mat-list-item>
        <mat-list-item>Taille maximale des cycles : {{selectedInstance.instance.properties.maxSizeCycle}}</mat-list-item>
        <mat-list-item>Taille maximale des chaines : {{selectedInstance.instance.properties.maxSizeChain}}</mat-list-item>
      </mat-list>



</mat-card>

<mat-card id="solution" style="border:1px solid blue;" *ngIf="selectedInstance">


  <mat-card style="background-color: grey; margin-top: 10px; margin-bottom: 10px">
    <mat-list>
      <h4>Solution de l'instance</h4>
      <mat-list-item>Algorithme utilisé : {{selectedInstance.algorithm.name}}</mat-list-item>
      <mat-list-item>Gain médical : {{selectedInstance.solution.gainMedTotal}}</mat-list-item>
      <mat-list-item>Nombre de cycles : {{selectedInstance.solution.cycles.length}}</mat-list-item>
      <mat-list-item>Nombre de chaines : {{selectedInstance.solution.chains.length}}</mat-list-item>
      <mat-list-item>Temps d'exécution : {{selectedInstance.algorithm.executionTime}}ms</mat-list-item>
      <mat-list-item>Pourcentage des pairs/altruists inutilisés : {{getPourcentage()}}%</mat-list-item>
    </mat-list>
  </mat-card>
  <mat-accordion class="example-headers-align" multi>

    <mat-card *ngIf="!selectedInstance.solution.chains.length" style="background-color: dimgrey">
      <mat-list>
        <h4>Chaines de la solution</h4>
        <mat-list-item style="color: #fa9a9a;">Aucune chaine générée</mat-list-item>
      </mat-list>
    </mat-card>
    <mat-expansion-panel *ngIf="selectedInstance.solution.chains.length" class="solution-info">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Chaines de la solution
        </mat-panel-title>
        <!--<mat-panel-description>
            Nombre de chaines : {{selectedInstance.solution.chains.length}}
        </mat-panel-description>-->
      </mat-expansion-panel-header>

      <div *ngFor="let chain of selectedInstance.solution.chains;" style="display: flex;padding: 10px;" >
        <div style="width:150px;">
          <p style="padding-top: 12px;">Gain Médical {{chain.gainMedSequence}}</p>
        </div>

        <div style="display: flex;flex-direction:row;margin-left: 20px">
          <div *ngFor="let sequence of chain.sequence; let i=index" >

            <div *ngIf="i<chain.sequence.length-1" style="position:relative;top: 18px; left: 53px;width:30px;">
              {{sequence.coutVersleSuivant}}
            </div>

            <div style="display: flex;flex-direction: row">
              <div class="res-circle" style="border:1px solid;"
                   [style.marginTop.px]="(i==chain.sequence.length-1) ? 19 : 0"
                   [style.backgroundColor]="sequence.isAltruist ? '#ff9f40' : '#bcd6ff'"
                   [style.borderColor]="sequence.isAltruist ? '#ff7f00' : '#0047AB'">
                <div class="circle-txt">{{sequence.id}}</div>
              </div>
              <div *ngIf="i<chain.sequence.length-1" style="display: flex;flex-direction: row">
                <svg xmlns="http://www.w3.org/2000/svg" height="42" width="15"
                     [attr.color]="(sequence.coutVersleSuivant==getTheBestLink(chain.sequence))?'green':
                                        (sequence.coutVersleSuivant==getTheWorstLink(chain.sequence))?'red':'black'">
                  <path d="M0 21.5 H 15V 25 H 0 L 0 20.5" fill="currentColor"></path>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" height="39" width="34" style="margin-top:3.5px;"
                     [attr.color]="(sequence.coutVersleSuivant==getTheBestLink(chain.sequence))?'green':
                                        (sequence.coutVersleSuivant==getTheWorstLink(chain.sequence))?'red':'black'">
                  <path d="M23.375 30.458 20.875 27.917 27.208 21.625H0V18.125H27.208L20.875 11.792L23.333 9.292L33.917 19.875Z" fill="currentColor"/>
                  <!--d="M27.375 37.458 24.875 32.917 22.208 28.625H0V25.125H27.208L20.875 11.792L23.333 9.292L43.917 26.875Z"-->
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-expansion-panel>

    <mat-card *ngIf="!selectedInstance.solution.cycles.length" style="background-color: dimgrey">
      <mat-list>
        <h4>Cycles de la solution</h4>
        <mat-list-item style="color: #fa9a9a;">Aucun cycle généré</mat-list-item>
      </mat-list>
    </mat-card>
    <mat-expansion-panel *ngIf="selectedInstance.solution.cycles.length" class="solution-info">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Cycles de la solution
        </mat-panel-title>
        <!--<mat-panel-description>
          Nombre de cycles : {{selectedInstance.solution.cycles.length}}
        </mat-panel-description>-->
      </mat-expansion-panel-header>
      <div  *ngFor="let cycle of selectedInstance.solution.cycles;" style="display: flex;padding: 10px;">
        <div style="width:150px;">
          <p style="padding-top: 12px;">Gain Médical {{cycle.gainMedSequence}}</p>
        </div>
        <div style="display: flex;flex-direction:row;margin-left: 20px;">
          <div *ngFor="let sequence of cycle.sequence;let i=index;" style="" >

            <div style="position:relative;"
                 [style.top.px]="(i<cycle.sequence.length-1)? 18:65"
                 [style.left.px]="(i<cycle.sequence.length-1)? 50:30">
              {{sequence.coutVersleSuivant}}
            </div>

            <div style="display: flex;flex-direction: row;">

              <div style="display: flex;flex-direction: column;">
                <div class="res-circle" style="border:1px solid #0047AB;background-color: #bcd6ff">
                  <div class="circle-txt">{{sequence.id}}</div>
                </div>
                <svg *ngIf="i==0" xmlns="http://www.w3.org/2000/svg" height="20" width="44"
                     [attr.color]="(cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                  <path d="M24 0 H 20.5 V 20 H 0L 24 20  " fill="currentColor"></path>
                </svg>
                <svg *ngIf="i==0" xmlns="http://www.w3.org/2000/svg" height="10" width="44"
                     [attr.color]="(cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                  <path d="M20.5 0 H  44 V 3.5 H 20.5 L 20.5 20.5  " fill="currentColor"></path>
                </svg>

                <svg *ngIf="i<cycle.sequence.length-1 && i>0" style="margin-top:20px;" xmlns="http://www.w3.org/2000/svg" height="10" width="44"
                     [attr.color]="(cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                  <path d="M0 0 H 50V 3.5 H 0 L 0 0  " fill="currentColor"></path>
                </svg>

                <svg *ngIf="i==cycle.sequence.length-1" xmlns="http://www.w3.org/2000/svg" height="20" width="44"
                     [attr.color]="(cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                  <path d="M24 0 H 20.5 V 20 H 0L 24 20  " fill="currentColor"></path>
                </svg>
                <svg *ngIf="i==cycle.sequence.length-1" xmlns="http://www.w3.org/2000/svg" height="10" width="44"
                     [attr.color]="(sequence.coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (sequence.coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                  <path d="M0 0 H  24 V 3.5 H 0 L 0 0" fill="currentColor"></path>
                </svg>

              </div>

              <div *ngIf="i<cycle.sequence.length-1" style="display: flex;flex-direction: column">
                <div style="display: flex;flex-direction: row">
                  <svg xmlns="http://www.w3.org/2000/svg" height="42" width="15"
                       [attr.color]="(sequence.coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (sequence.coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                    <path d="M0 21.5 H 15V 25 H 0 L 0 20.5" fill="currentColor"></path>
                  </svg>
                  <svg xmlns="http://www.w3.org/2000/svg" height="39" width="34" style="margin-top:3.5px;"
                       [attr.color]="(sequence.coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (sequence.coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                    <path d="M23.375 30.458 20.875 27.917 27.208 21.625H0V18.125H27.208L20.875 11.792L23.333 9.292L33.917 19.875Z" fill="currentColor"/>
                  </svg>
                </div>
                <svg style="margin-top:21.5px;" xmlns="http://www.w3.org/2000/svg" height="10" width="49"
                     [attr.color]="(cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheBestLink(cycle.sequence))?'green':
                                        (cycle.sequence[cycle.sequence.length-1].coutVersleSuivant==getTheWorstLink(cycle.sequence))?'red':'black'">
                  <path d="M0 0 H 59V 3.5 H 0 L 0 0 " fill="currentColor"/>
                </svg>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-expansion-panel>

    <mat-card *ngIf="(selectedInstance.instance.altruists.length == 0) && (selectedInstance.instance.pairs.length == 0)" style="background-color: dimgrey">
      <mat-list>
        <h4>Les Pairs/Altruists non-utilisés</h4>
        <mat-list-item style="color: #9afaa7;">Tous les pairs et altruistes on été utilisés</mat-list-item>
      </mat-list>
    </mat-card>
    <mat-expansion-panel class="solution-info" *ngIf="selectedInstance && !((selectedInstance.instance.altruists.length == 0) && (selectedInstance.instance.pairs.length == 0))">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Les Pairs/Altruists non-utilisés
        </mat-panel-title>
        <!--<mat-panel-description>
            Pourcentage des pairs/altruists inutilisés {{getPourcentage()}}%
        </mat-panel-description>-->
      </mat-expansion-panel-header>
      <div style="display: flex;flex-direction: row;flex-wrap: wrap;padding: 10px;">
        <div *ngFor="let altruists of selectedInstance.instance.altruists;let i=index">
          <div
            [style.display]="(checkIsInSolution(altruists.id)) ? 'block': 'none' "
            class="res-circle" style="border:1px solid #ff7f00;background-color: #ff9f40;margin: 5px">
            <div class="circle-txt">{{altruists.id}}</div>
          </div>
        </div>
        <div *ngFor="let pairs of selectedInstance.instance.pairs;let i=index">
          <div
            [style.display]="(checkIsInSolution(pairs.id)) ? 'block': 'none' "
            class="res-circle" style="border:1px solid #0047AB;background-color: #bcd6ff;margin: 5px">
            <div class="circle-txt">{{pairs.id}}</div>
          </div>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</mat-card>

</div>

<!--

<mat-card style="height: 40px">
  <mat-card-header>
    <h1>BINKS</h1>

  </mat-card-header>
</mat-card>



-->




  <!--<div *ngIf="selectedInstance" style="display: flex">



    <div *ngFor="let cycle of selectedInstance.solution.cycles;">
      Chains : {{cycle.gainMedSequence}}
      <div *ngFor="let sequence of cycle.sequence; let i=index">
        <div style="display: flex;flex-direction: row;">
          <div class="res-circle" style="border:1px solid red;">
            <div class="circle-txt">{{sequence.id}}</div>
          </div>
        </div>
        <div style="display: flex;flex-direction: row;">
          <svg *ngIf="i<cycle.sequence.length-1" style="margin-left:2px" xmlns="http://www.w3.org/2000/svg" height="44" width="48">
            <path d="M24 44 10 30 12.1 27.9 22.5 38.3V0H25.5V38.3L35.9 27.9L38 30Z"/>
          </svg>
        </div>
      </div>

    </div>

    <div  *ngFor="let cycle of selectedInstance.solution.chains;">

      Cycle : {{cycle.gainMedSequence}}

      <div style="border:1px solid red;display: flex;flex-wrap: wrap;flex-direction: row" >

        <div style="border: 1px solid green">

          <div *ngFor="let sequence of cycle.sequence;let i=index" >

            <div *ngIf="i==0" >



              <div style="display: flex;flex-direction: row;">
                <div class="res-circle" style="border:1px solid red;">
                  <div class="circle-txt">{{sequence.id}}</div>
                </div>

                <svg xmlns="http://www.w3.org/2000/svg" height="44" width="44">
                  <path d="M0 25 H 44 V 22 H 0 L 0 20  "/>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" height="50" width="10">
                  <path d="M0 22 H 3 V 50 H 0 L 0 50 "/>
                </svg>
              </div>

              <div style="display: flex;flex-direction: row">
                <svg style="margin-left:2px" xmlns="http://www.w3.org/2000/svg" height="44" width="48">
                  <path d="M24 44 10 30 12.1 27.9 22.5 38.3V0H25.5V38.3L35.9 27.9L38 30Z"/>
                </svg>
                <svg style="margin-left:44px;" xmlns="http://www.w3.org/2000/svg" height="44" width="10">
                  <path d="M0 0 H 3 V 44 H 0 L 0 44 "/>
                </svg>
              </div>
            </div>



            <div *ngIf="i<cycle.sequence.length-1 && i>0">
              <div style="display: flex;flex-direction: row">
                <div  class="res-circle" style="border:1px solid red;">
                  <div class="circle-txt">{{sequence.id}}</div>
                </div>
                <svg style="margin-left:44px;" xmlns="http://www.w3.org/2000/svg" height="50" width="10">
                  <path d="M0 0 H 3 V 50 H 0 L 0 50 "/>
                </svg>
              </div>

              <div style="display: flex;flex-direction: row">
                <svg style="margin-left:2px;" xmlns="http://www.w3.org/2000/svg" height="44" width="48">
                  <path d="M24 44 10 30 12.1 27.9 22.5 38.3V0H25.5V38.3L35.9 27.9L38 30Z"/>
                </svg>
                <svg style="margin-left:44px;" xmlns="http://www.w3.org/2000/svg" height="44" width="10">
                  <path d="M0 0 H 3 V 44 H 0 L 0 44 "/>
                </svg>
              </div>
            </div>

            <div *ngIf="i==cycle.sequence.length-1" >

              <div style="display: flex;flex-direction: row">
                <div class="res-circle" style="border:1px solid red;">
                  <div class="circle-txt">{{sequence.id}}</div>
                </div>


                <svg xmlns="http://www.w3.org/2000/svg" height="44" width="44">
                  <path d="M0 25 H 44 V 22 H 0 L 0 20  "/>
                </svg>
                <svg xmlns="http://www.w3.org/2000/svg" height="50" width="10">
                  <path d="M0 0 H 3 V 25 H 0 L 0 25 "/>
                </svg>


              </div>


            </div>










          </div>
        </div>

      </div>


    </div>


  </div>-->











<!--

<mat-card *ngIf="selectedInstance">

  <div style="display: flex;flex-direction: row;flex-wrap: wrap;padding: 10px;">
    <div *ngFor="let altruists of selectedInstance.instance.altruists;let i=index">
      <div
        [style.display]="(checkIsInSolution(altruists.id)) ? 'block': 'none' "
        class="res-circle" style="border:1px solid #ff7f00;background-color: #ff9f40;margin: 5px">
        <div class="circle-txt">{{altruists.id}}</div>
      </div>


    </div>
    <div *ngFor="let pairs of selectedInstance.instance.pairs;let i=index">
      <div
        [style.display]="(checkIsInSolution(pairs.id)) ? 'block': 'none' "
        class="res-circle" style="border:1px solid #0047AB;background-color: #bcd6ff;margin: 5px">
        <div class="circle-txt">{{pairs.id}}</div>
      </div>


    </div>


  </div>



</mat-card>
-->
<!--
<div class="res-circle" style="border:1px solid red;">
  <div class="circle-txt">test</div>
</div>
<svg xmlns="http://www.w3.org/2000/svg" height="44" width="48"><path d="M24 44 10 30 12.1 27.9 22.5 38.3V0H25.5V38.3L35.9 27.9L38 30Z"/></svg>
<div class="res-circle" style="border:1px solid red;">
  <div class="circle-txt">test</div>
</div>-->




